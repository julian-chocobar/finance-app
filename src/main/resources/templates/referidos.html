<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Lista de Referidos</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>

<script th:src="@{/js/referidos.js}"></script>
	
	<!-- Modal -->
	<div id="modal-overlay">
	    <div id="modal-content">
	        <button id="modal-close-btn" onclick="ocultarModal()">&times;</button>
	        <form id="referidoForm" method="post">
	            <label>Nombre:</label>
	            <input type="text" id="nombre" name="nombre" required>

	            <label>Teléfono:</label>
	            <input type="text" id="telefono" name="telefono">

	            <label>Email:</label>
	            <input type="email" id="email" name="email">

	            <label>Dirección:</label>
	            <input type="text" id="direccion" name="direccion">

	            <button type="submit">Guardar</button>
	            <button type="button" onclick="ocultarModal()">Cancelar</button>
	        </form>
	    </div>
	</div>
		
<!-- Botón para abrir la barra lateral -->
<div class="open-btn" onclick="toggleSidebar()">&#9776;</div>

<!-- Barra lateral -->
<div id="sidebar">
    <a href="javascript:void(0)" class="close-btn" onclick="toggleSidebar()">&times;</a>
    <a href="/operaciones">Operaciones</a>
    <a href="/clientes">Clientes</a>
	<a href="/referidos">Referidos</a>
</div>

<!-- Contenido principal -->
<div id="main">
    <h1>Referidos</h1>
	
	<div class="header-container">
	    <!-- Formulario de búsqueda -->
	    <form th:action="@{/referidos}" method="get" class="form-busqueda">
	        <input type="text" name="nombre" placeholder="Buscar por nombre" th:value="${nombreFiltro}">
	        <button type="submit">Buscar</button>
	    </form>

	    <!-- Botón "Nuevo Referido" -->
	    <div class="btn-nuevo-referido-container">
	        <button onclick="mostrarModal('crear')">Nuevo Referido</button>
	    </div>
	</div>
	
    <!-- Verifica si hay datos -->
    <div th:if="${referidos != null and !referidos.empty}">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Teléfono</th>
                    <th>Email</th>
                    <th>Dirección</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="referido : ${referidos.content}">
                    <td th:text="${referido.id}">1</td>
                    <td th:text="${referido.nombre}">Nombre</td>
                    <td th:text="${referido.telefono}">Teléfono</td>
                    <td th:text="${referido.email}">Email</td>
                    <td th:text="${referido.direccion}">Dirección</td>
					<td>
					    <!-- Botón de Editar con ícono -->
					    <button th:attr="onclick=|mostrarModal('editar', '${referido.id}', '${referido.nombre}', '${referido.telefono}', '${referido.email}', '${referido.direccion}')|">
					        <i class="fas fa-edit"></i>
					    </button>

					    <!-- Botón de Eliminar con ícono -->
					    <button th:attr="onclick=|confirmarEliminacion('${referido.id}')|">
					        <i class="fas fa-trash-alt"></i>
					    </button>

					    <!-- Botón de Cuenta Corriente (CC) -->
					    <a th:href="@{/ctas-ctes/referidos/{referidoId}(referidoId=${referido.id})}">
					        <button>CC</button>
					    </a>
					</td>
                </tr>
            </tbody>
        </table>
    </div>
	
	    <!-- Paginación -->
	    <div th:if="${referidos.totalPages > 1}">
	        <span th:if="${!referidos.first}">
	            <a th:href="@{/referidos(page=0, size=${referidos.size})}">Primera</a>
	        </span>
	        <span th:if="${referidos.hasPrevious()}">
	            <a th:href="@{/referidos(page=${referidos.number - 1}, size=${referidos.size})}">Anterior</a>
	        </span>
	        <span th:each="i : ${#numbers.sequence(1, referidos.totalPages)}">
	            <a th:if="${i - 1 != referidos.number}" 
	               th:href="@{/referidos(page=${i - 1}, size=${referidos.size})}" 
	               th:text="${i}">1</a>
	            <span th:unless="${i - 1 != referidos.number}" th:text="${i}">1</span>
	        </span>
	        <span th:if="${referidos.hasNext()}">
	            <a th:href="@{/referidos(page=${referidos.number + 1}, size=${referidos.size})}">Siguiente</a>
	        </span>
	        <span th:if="${!referidos.last}">
	            <a th:href="@{/referidos(page=${referidos.totalPages - 1}, size=${referidos.size})}">Última</a>
	        </span>
	    </div>

	    <!-- Información de la paginación -->
	    <div>
	        <p>Página <span th:text="${referidos.number + 1}">1</span> de <span th:text="${referidos.totalPages}">1</span></p>
	        <p>Total de referidos: <span th:text="${referidos.totalElements}">0</span></p>
	    </div>
	</div>


</body>
</html>
